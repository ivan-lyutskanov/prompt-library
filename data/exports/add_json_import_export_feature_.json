{"title":"Add JSON Import/Export Feature ","content":"## Context\r\nYou have a FastAPI application with HTMX frontend that manages prompts with associated notes. The app uses:\r\n- FastAPI with SQLAlchemy ORM\r\n- HTMX + Alpine.js for frontend interactivity\r\n- Jinja2 templates with component-based architecture\r\n- A modal system for viewing/editing prompts\r\n\r\n## Requirements\r\nAdd the ability to:\r\n1. **Export** individual prompts (with notes) as JSON files\r\n2. **Import** prompts from JSON files, recreating them with their notes\r\n\r\n## Implementation Details\r\n\r\n### Backend (app/main.py)\r\n1. Add `UploadFile`, `File` to FastAPI imports\r\n2. Add `json` module import\r\n3. Create GET endpoint `/prompts/{prompt_id}/export`:\r\n   - Returns JSON with prompt title, content, timestamps\r\n   - Includes nested notes array with content and timestamps\r\n   - Uses ISO format for datetime serialization\r\n4. Create POST endpoint `/prompts/import`:\r\n   - Accepts file upload with `UploadFile = File(...)`\r\n   - Parses JSON, validates required fields (title, content)\r\n   - Creates prompt using CRUD operations\r\n   - Iterates through notes array (if present) and creates them\r\n   - Returns updated prompt list HTML component for HTMX swap\r\n   - Handles JSONDecodeError and general exceptions with proper HTTP errors\r\n\r\n### Frontend - Modal (templates/components/prompt_modal.html)\r\n1. Modify the footer section from single button to flex layout (`flex justify-between items-center`)\r\n2. Add \"Export JSON\" button next to existing \"Edit Prompt\" button:\r\n   - Uses Alpine.js inline async function with `@click`\r\n   - Fetches from `/prompts/${currentPrompt?.id}/export`\r\n   - Creates blob from response\r\n   - Dynamically generates filename from prompt title (sanitized, lowercase, underscores)\r\n   - Programmatically triggers download via temporary `<a>` element\r\n   - Cleans up DOM and blob URL after download\r\n   - Styled with bordered button style (border-2, blue-600 colors)\r\n   - Includes download SVG icon\r\n\r\n### Frontend - Main Page (templates/index.html)\r\n1. Add `importLoading: false` to Alpine.js root data\r\n2. Create `handleImport(event)` method in Alpine.js data:\r\n   - Gets file from event target\r\n   - Sets loading state\r\n   - Creates FormData and appends file\r\n   - Posts to `/prompts/import` endpoint\r\n   - On success: updates prompts-list innerHTML and calls `htmx.process()` to re-enable HTMX\r\n   - On error: shows alert with error detail\r\n   - Resets file input value\r\n   - Clears loading state in finally block\r\n3. Modify \"Add New Prompt\" section to flex layout (`flex justify-between items-center`)\r\n4. Add \"Import JSON\" button as file input label:\r\n   - Hidden file input accepting `.json` files\r\n   - Custom styled label that looks like a button\r\n   - Calls `handleImport($event)` on file change\r\n   - Shows \"Importing...\" text when loading\r\n   - Disabled state when import in progress\r\n   - Includes upload SVG icon\r\n\r\n## JSON Format\r\n```json\r\n{\r\n  \"title\": \"Prompt Title\",\r\n  \"content\": \"Prompt content...\",\r\n  \"created_at\": \"2024-01-01T12:00:00\",\r\n  \"updated_at\": \"2024-01-01T12:00:00\",\r\n  \"notes\": [\r\n    {\r\n      \"content\": \"Note content\",\r\n      \"created_at\": \"2024-01-01T12:00:00\",\r\n      \"updated_at\": \"2024-01-01T12:00:00\"\r\n    }\r\n  ]\r\n}","created_at":"2025-11-17T13:23:03.720546","updated_at":"2025-11-17T13:23:40.631600","notes":[]}