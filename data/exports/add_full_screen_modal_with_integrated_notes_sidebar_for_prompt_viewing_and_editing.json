{"title":"Add Full-Screen Modal with Integrated Notes Sidebar for Prompt Viewing and Editing","content":"Implement a full-screen modal feature for the Prompt Library application that allows users to view and edit prompts with an integrated notes sidebar. The modal should provide a better reading experience for long prompts and enable managing notes alongside the prompt content.\n\nRequirements\n\n1. Modal Component (templates/components/prompt_modal.html)\nCreate a full-screen modal with the following features:\n•  Two-column layout: Left column for prompt content (2/3 width), right column for notes sidebar (1/3 width)\n•  Modal modes: View mode and Edit mode for prompts\n•  Header: Display prompt title, last updated timestamp, and close button\n•  Backdrop: Semi-transparent black background that closes modal when clicked\n•  Animations: Smooth fade-in/fade-out transitions using Alpine.js x-transition\n•  Escape key: Close modal when ESC key is pressed\n•  Body scroll lock: Prevent background scrolling when modal is open\n\n2. Prompt Viewing & Editing in Modal\n•  View Mode: Display prompt content with formatted text (pre-wrap whitespace), show \"Edit Prompt\" button\n•  Edit Mode: Form with title input and large content textarea (min-height 400px), \"Save Changes\" and \"Cancel\" buttons\n•  Form submission: Use Alpine.js fetch API (not HTMX) due to dynamic URL requirements based on currentPrompt.id\n•  Change tracking: Set promptChanged = true when edits are saved to trigger card refresh on modal close\n\n3. Notes Sidebar in Modal\n•  Header: \"Notes\" title with \"+ Add Note\" toggle button\n•  Add Note Form: Collapsible form with textarea and submit/cancel buttons\n•  Notes List: Display all notes for the current prompt using modal-specific templates\n•  Real-time updates: Notes operations update the sidebar without closing modal\n•  Context detection: Use Alpine.js fetch with HX-Target: 'modal-notes-list' header to indicate modal context\n\n4. Modal-Specific Note Components\nCreate separate note components for modal to avoid DOM ID conflicts:\n•  templates/components/modal_notes_list.html: Container for modal notes\n•  templates/components/modal_note_card.html: Individual note card with edit/delete, uses modal-note-{id} IDs\n\n5. Backend API Endpoints (app/main.py)\nAdd three new endpoints:\n\nGET /prompts/{prompt_id}/modal: Return prompt data as JSON for modal initialization\npython\nGET /prompts/{prompt_id}/notes-list: Return HTML for modal notes list using modal_notes_list.html template\n\nGET /prompts/{prompt_id}/card: Return HTML for prompt card to refresh after modal changes\n\n6. Context-Aware Note Operations\nModify existing note endpoints to detect modal context via HX-Target header:\n\nPOST /prompts/{prompt_id}/notes: \n•  Check if HX-Target contains \"modal-notes-list\"\n•  Return modal_notes_list.html for modal, notes_section.html for card view\n\nPUT /notes/{note_id}:\n•  Check if HX-Target contains \"modal-note\"\n•  Return modal_note_card.html for modal, note_card.html for card view\n\n7. Alpine.js State Management (templates/index.html)\nAdd root-level Alpine.js data with:\n•  showModal: Boolean for modal visibility\n•  modalMode: 'view' or 'edit' mode\n•  currentPrompt: Object holding current prompt data\n•  promptChanged: Boolean to track if changes were made\n•  openModal(promptId): Fetch prompt data, load notes, show modal, lock body scroll\n•  closeModal(): Refresh card if changed, hide modal, unlock body scroll\n•  toggleEdit(): Switch between view and edit modes\n•  submitPromptEdit(event): Handle form submission via fetch API, update card in background, refresh modal data\n•  loadModalContent(promptId): Load notes list via HTMX\n•  @keydown.escape.window: Close modal on ESC key\n\n8. Prompt Card Click Handlers (templates/components/prompt_card.html)\nMake prompt title and content clickable to open modal:\n•  Add @click=\"openModal({{ prompt.id }})\" to title h3 element\n•  Add hover effects: title changes to blue, content gets light gray background\n•  Add cursor-pointer class to both elements\n\n9. Include Modal in Main Template\nAdd {% include \"components/prompt_modal.html\" %} at the end of the prompts list container in templates/index.html\n\nTechnical Implementation Details\n\nHybrid HTMX/Fetch Pattern\n•  Why: HTMX doesn't support dynamic attribute values from Alpine.js (e.g., :hx-post)\n•  Solution: Use Alpine.js fetch API for operations requiring dynamic URLs (modal prompt editing, adding notes in modal)\n•  After fetch: Manually update DOM and call htmx.process() to re-enable HTMX on new elements\n\nChange Tracking & Card Refresh\n•  Set promptChanged = true whenever:\n◦  Prompt is edited in modal\n◦  Notes are added/edited/deleted in modal\n•  On modal close, if promptChanged, use HTMX ajax to fetch fresh card HTML via /prompts/{id}/card and swap #prompt-{id} element\n\nID Namespacing\n•  Card notes use IDs: note-{id}\n•  Modal notes use IDs: modal-note-{id}\n•  This prevents conflicts when the same note is displayed in both contexts\n\nBody Scroll Management\n•  Lock: document.body.style.overflow = 'hidden' when modal opens\n•  Unlock: document.body.style.overflow = '' when modal closes\n\nExpected User Experience\n1. User clicks on prompt title or content in the card view\n2. Modal smoothly fades in with the full prompt content visible\n3. User can read the entire prompt without scrolling the main page\n4. User can click \"Edit Prompt\" to modify title/content, then save\n5. User can manage notes in the right sidebar without closing the modal\n6. When modal closes, the corresponding card in the main view automatically refreshes if any changes were made\n7. ESC key or clicking backdrop closes the modal","created_at":"2025-11-17T09:55:37.313305","updated_at":"2025-11-17T09:55:44.442451","notes":[{"content":"This prompt was generated after the feature development with multiple iterations over the initial ideation and implementation.","created_at":"2025-11-17T09:58:34.577669","updated_at":"2025-11-17T09:58:34.577672"}]}